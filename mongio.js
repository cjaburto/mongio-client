(function(){var r,e;e=void 0===window.socket||""===window.socket||null===window.socket?io():window.socket,r=function(){function r(){}return r.prototype.connect=function(r){var t;return t=Q.defer(),e.emit("connectDb",r,function(r){return"ok"===r.status&&t.resolve(r.res),"err"===r.status?t.reject(new Error(r.err)):void 0}),t.promise},r.prototype.stats=function(){var r;return r=Q.defer(),e.emit("mio-dbstats",function(e){switch(e.status){case"ok":return r.resolve(e.res);case"err":return r.reject(new Error(obj.err))}}),r.promise},r.prototype.collection=function(r){return{stats:function(){var t;return t=Q.defer(),e.emit("mio-colstats",r,function(r){switch(r.status){case"ok":return t.resolve(r.res);case"err":return t.reject(new Error(r.err))}}),t.promise},find:function(t){return{vlimit:void 0,vskip:void 0,vsort:void 0,vproy:void 0,limit:function(r){return this.vlimit=r,this},skip:function(r){return this.vskip=r,this},sort:function(r){return this.vsort=r,this},complete:function(o){var n;return void 0===t&&(t={}),void 0===this.vsort&&(this.vsort={_id:-1}),n={collection:r,query:t,skip:this.vskip,limit:this.vlimit,sort:this.vsort},e.emit("find",n,function(r){return o(r)}),this}}},remove:function(t){var o,n;return n=Q.defer(),o={collection:r,query:t},e.emit("remove",o,function(r){return"ok"===r.status&&n.resolve(r.res),"err"===r.status?n.reject(new Error(r.err)):void 0}),n.promise},findOne:function(t){var o,n;return n=Q.defer(),o={collection:r,query:t},e.emit("findOne",o,function(r){return"ok"===r.status&&n.resolve(r.res),"!exist"===r.status&&n.reject(new Error("!exist")),"err"===r.status?n.reject(new Error(r.err)):void 0}),n.promise},save:function(t,o){var n,s;return n=Q.defer(),void 0===o&&(o=!1),s={collection:r,query:t,verify:o.verify},e.emit("save",s,function(r){switch(r.status){case"ok":return n.resolve(r.res);case"exist":return n.resolve("exist");case"err":return n.reject(new Error(r.err))}}),n.promise},update:function(t,o,n){var s,i;return s=Q.defer(),i={collection:r,query:t,update:o,options:n},e.emit("update",i,function(r){switch(r.status){case"ok":return s.resolve(r.res);case"err":return s.reject(new Error(r.err))}}),s.promise},count:function(t){var o,n;return o=Q.defer(),n={col:r,query:t},e.emit("mio-count",n,function(r){switch(r.status){case"ok":return o.resolve(r.res);case"err":return o.reject(new Error(r.err))}}),o.promise},drop:function(){var t;return t=Q.defer(),e.emit("drop",r,function(r){return"ok"===r.status&&t.resolve(r.res),"err"===r.status?t.reject(new Error(r.err)):void 0}),t.promise}}},r.prototype.chkpasswd=function(r){var t,o;return t=Q.defer(),o={query:r},e.emit("chkpasswd",o,function(r){switch(console.log(r),r.status){case"ok":return t.resolve(r.res);case"!match":return t.resolve("!match");case"err":return t.reject(new Error(r.err))}}),t.promise},r.prototype.mongoimport=function(r){var t;return t=Q.defer(),e.emit("mongoimport",r,function(r){return"ok"===r.status&&t.resolve(r.res),"stderr"===r.status&&t.reject(new Error(r.err)),"err"===r.status?t.reject(new Error(r.err)):void 0}),t.promise},r}(),window.db=new r}).call(this);
