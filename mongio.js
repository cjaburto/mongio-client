(function(){var r,e;e=void 0===window.socket||""===window.socket||null===window.socket?io():window.socket,r=function(){function r(){}return r.prototype.connect=function(r){var t;return t=Q.defer(),e.emit("connectDb",r,function(r){return"ok"===r.status&&t.resolve(r.res),"err"===r.status?t.reject(new Error(r.err)):void 0}),t.promise},r.prototype.collection=function(r){return{find:function(t){return{vlimit:void 0,vskip:void 0,vsort:void 0,vproy:void 0,limit:function(r){return this.vlimit=r,this},skip:function(r){return this.vskip=r,this},sort:function(r){return this.vsort=r,this},complete:function(o){var s;return void 0===t&&(t={}),void 0===this.vsort&&(this.vsort={_id:-1}),s={collection:r,query:t,skip:this.vskip,limit:this.vlimit,sort:this.vsort,proyection:this.vproy},e.emit("find",s,function(r){return o(r)}),this}}},remove:function(t){var o,s;return s=Q.defer(),o={collection:r,query:t},e.emit("remove",o,function(r){return"ok"===r.status&&s.resolve(r.res),"err"===r.status?s.reject(new Error(r.err)):void 0}),s.promise},findOne:function(t){var o,s;return s=Q.defer(),o={collection:r,query:t},e.emit("findOne",o,function(r){return"ok"===r.status&&s.resolve(r.res),"!exist"===r.status&&s.reject(new Error("!exist")),"err"===r.status?s.reject(new Error(r.err)):void 0}),s.promise},save:function(t,o){var s,n;return s=Q.defer(),void 0===o&&(o=!1),n={collection:r,query:t,verify:o.verify},e.emit("save",n,function(r){switch(r.status){case"ok":return s.resolve(r.res);case"exist":return s.resolve("exist");case"err":return s.reject(new Error(r.err))}}),s.promise},update:function(t,o,s){var n,i;return n=Q.defer(),i={collection:r,query:t,update:o,options:s},e.emit("update",i,function(r){switch(r.status){case"ok":return n.resolve(r.res);case"err":return n.reject(new Error(r.err))}}),n.promise},password:function(t){var o,s;return s=Q.defer(),o={collection:r,user:t.user,newPass:t.newPass,oldPass:t.oldPass},e.emit("changePass",o,function(r){switch(res.status){case"ok":return s.resolve(r.res);case"!match":return s.resolve("!match");case"err":return s.reject(new Error(r.err))}}),s.promise},drop:function(){var t;return t=Q.defer(),e.emit("drop",r,function(r){return"ok"===r.status&&t.resolve(r.res),"err"===r.status?t.reject(new Error(r.err)):void 0}),t.promise}}},r.prototype.chkpasswd=function(r){var t,o;return t=Q.defer(),o={query:r},e.emit("chkpasswd",o,function(r){switch(console.log(r),r.status){case"ok":return t.resolve(r.res);case"!match":return t.resolve("!match");case"err":return t.reject(new Error(r.err))}}),t.promise},r.prototype.mongoimport=function(r){var t;return t=Q.defer(),e.emit("mongoimport",r,function(r){return"ok"===r.status&&t.resolve(r.res),"stderr"===r.status&&t.reject(new Error(r.err)),"err"===r.status?t.reject(new Error(r.err)):void 0}),t.promise},r}(),window.db=new r}).call(this);